SELECT current server AS ENV, TABSCHEMA,TABNAME,COLNAME,COLNO+1 AS COLNO,TYPENAME as DATA_TYPE,
CASE 
        WHEN TYPENAME IN ('CHARACTER', 'CLOB', 'LONG VARCHAR', 'VARCHAR', 'STRING') THEN 'TEXT'
        WHEN TYPENAME IN ('BIGINT', 'INTEGER', 'SMALLINT', 'DECIMAL', 'DOUBLE', 'FLOAT') THEN 'NUMBER'
        WHEN TYPENAME IN ('XML') THEN 'VARIANT'
        WHEN TYPENAME IN ('TIMESTAMP') THEN 'TIMESTAMP_NTZ'
        WHEN TYPENAME IN ('DATE') THEN 'DATE'
        ELSE 'UNKNOWN'
    END AS SNOWFLAKE_TYPE,
CASE WHEN KEYSEQ > 0 THEN 'Y' 
ELSE '' END AS PRIMARY_KEY_FLAG,
CASE
WHEN TYPENAME in ('INTEGER','SMALLINT','BIGINT') AND LENGTH <= 38 THEN 38
    ELSE LENGTH
END AS DERIVED_LENGTH,
LENGTH,SCALE,COALESCE(DEFAULT,'') AS DEFAULT,NULLS AS NULLABLE
FROM   syscat.columns  
WHERE tabschema IN ()
AND tabname IN ()
ORDER BY 3,5;